import{_ as e,c as o,o as a,d as s}from"./app.d643be22.js";const r="/me/assets/projeto-ssg-1.bf238fd2.png",q=JSON.parse('{"title":"Dump Mental 2 - Meu projeto para SSG","description":"","frontmatter":{},"headers":[],"relativePath":"posts/2024/PT-dump-mental-blogs-parte-2.md"}'),i={name:"posts/2024/PT-dump-mental-blogs-parte-2.md"},t=s(`<h1 id="dump-mental-2-meu-projeto-para-ssg" tabindex="-1">Dump Mental 2 - Meu projeto para SSG <a class="header-anchor" href="#dump-mental-2-meu-projeto-para-ssg" aria-hidden="true">#</a></h1><p>PS: Este texto \xE9 mais um dump mental, n\xE3o \xE9 um artigo t\xE9cnico, n\xE3o espere coer\xEAncia o tempo todo, t\xE3o pouco quaisquer ensinamentos. Alias, espere grandes devaneios e brisas. Se voc\xEA est\xE1 por fora de tudo, leia o primeiro post para come\xE7ar a entender como cheguei aqui: <a href="/me/posts/2024/PT-desafios-e-solucoes-na-gestao-de-blogs-com-mais-de-50-mil-artigos-ia-rust-e-vue.html">Desafios e solu\xE7\xF5es na Gest\xE3o de blogs com +50 mil artigos - IA, Rust e Vue</a></p><p>Desde o \xFAltimo post, que foi dia 10/04/2024, se passaram 19 dias. No dia em que eu o escrevi, eu estava tentando analisar se valeria a pena escrever uma solu\xE7\xE3o para ter mais controle sobre meus blogs (aos quais essa s\xE9rie de posts se refere) e de l\xE1 pra c\xE1 eu analisei, planejei e iniciei.</p><p>Depois de alguns dias planejando e entendendo quais features eram essenciais, como fazer, modelagens, etc. Eu comecei o projeto.</p><p>Seguindo a simples premissa inicial de &quot;Fazer build do meu blog sem gastar mais de 10gb de mem\xF3ria RAM.&quot;, hoje eu conclui a primeira etapa e posso dizer que consegui. Usando como modelo um blog com exatos 63338 artigos + 634 p\xE1ginas que listam os artigos de 100 em 100, eu consegui chegar no seguinte benchmark:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">Duration: 0:03:32.766377</span></span>
<span class="line"><span style="color:#A6ACCD;">Debug: RSS: 194.05 MB | VMS: 462.56 MB | Data: 213.73 MB | USS: 181.77 MB | PSS: 182.84 MB | Processed: 63338 | Uso da CPU: 103.40%</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Este \xE9 o print do final do processo, o uso de mem\xF3ria e CPU obviamente variou no decorrer da execu\xE7\xE3o mas n\xE3o passou muito de 230mb em rss.</p><p>N\xE3o sou especialista em analise de consumo de mem\xF3ria, mas estou considerando o uso do <code>RSS</code> (Resident Set Size) pois, pelo que entendi, \xE9 o que o meu processo &quot;comeu&quot; da mem\xF3ria f\xEDsica.</p><p>\xC9 interessant\xEDssimo ter esse controle, eu posso tentar bater um tempo menor que os 3 minutos que estou gastando se eu considerar ok gastar mais mem\xF3ria RAM e/ou incluir mais threads para os processos ass\xEDncronos. Um exemplo legal \xE9 que, se eu parar de fazer os processos assincronos eu consigo economizar bastante mem\xF3ria RAM pois s\xF3 o fato de disparar as threads j\xE1 aumentam o consumo. Pensando nisso, se meu objetivo \xE9 economia de mem\xF3ria, preciso analisar bem se realmente \xE9 vi\xE1vel o uso de threads em alguns cen\xE1rios, por hora est\xE1 legal como est\xE1, mas pode ser melhor.</p><p>Para um trabalho de menos de um m\xEAs e apenas nas horas vagas, est\xE1 bom assim por agora. J\xE1 resolver\xE1 meu problema real.</p><p>Estou fazendo tudo isso em <code>python</code> e \xE9 engra\xE7ado pensar que talvez eu alcance uma performance melhor do que a do <code>Zola</code> que \xE9 feito em <code>Rust</code>. Mas \xE9 isso, as vezes tem mais haver com a arquitetura que foi pensada do que com a linguagem. Pelo fato do meu projeto j\xE1 estar nascendo com essa premissa e em um cen\xE1rio maior do que blogs comuns, eu posso tomar algumas decis\xF5es voltadas para essa necessidade. Ent\xE3o, mesmo que eu cometa alguns erros de arquitetura e modelagem, pelo fato de eu estar a todo momento analisando minhas entregas com foco em otimiza\xE7\xE3o, eu consigo fazer alguns bons acertos. Claro que n\xE3o \xE9 nem justo comparar, o <code>Zola</code> \xE9 incr\xEDvel e a comunidade \xE9 muito legal tamb\xE9m, meu objetivo nem \xE9 ter as mesmas features, s\xF3 quero resolver os problemas que tenho nos meus cen\xE1rios e estou tendo a chance de aprender um pouco mais a cada fase.</p><p>Como por exemplo minha decis\xE3o de sair dos arquivos <code>.md</code> e colocar tudo dentro do <code>sqlite</code>, isso me d\xE1 o poder de paginar e iterar de forma bem simpes e ainda poderei fazer a administra\xE7\xE3o dos dados em algum painel como um <code>sqladmin</code> da vida, embutido no meu projeto. H\xE1 um ponto meio cr\xEDtico em rela\xE7\xE3o a isso que \xE9 o fato do meu arquivo <code>sqlite</code> j\xE1 ocupar mais de 200mb de armazenamento, isso faz com que seja necess\xE1rio criar um reposit\xF3rio <code>git</code> diferente para lidar com arquivos maiores, n\xE3o que seja um problema, mas \xE9 importante saber. Ainda estou pensando nisso e em algumas abordagens, por exemplo, eu poderia tentar quebrar em mais arquivos de <code>sqlite</code> para n\xE3o bater esses limites, sei l\xE1. Eu tamb\xE9m poderia manter os <code>markdowns</code> e s\xF3 usar o <code>sqlite</code> como algo tempor\xE1rio para me ajudar nas builds, n\xE3o sei, vamos ver em breve.</p><p>Vamos falar um pouco da experi\xEAncia de modelar tudo isso e ir desenvolvendo as features.</p><p>Eu considerei que vou migrar e desenvolver mais ferramentas do que s\xF3 o gerador de sites est\xE1ticos, vou migrar outras ferramentas que eu tenho para dentro desse framework, por conta disso eu busquei alguma solu\xE7\xE3o escal\xE1vel em termos de c\xF3digo para ir incluindo novos m\xF3dulos de maneira simples, ent\xE3o, pensando agora criei novas premissas j\xE1 no inicio para ficar organizado:</p><ol><li>Usar um sistema de m\xF3dulos;</li><li>Pacote pip: 2.1. Poder importar os m\xF3dulos em outras aplica\xE7\xF5es; 2.1. Poder usar os comandos via CLI</li></ol><p>Isso significa que o projeto pode ser usado assim direto no terminal:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ projeto-name {modulo} {parametros}</span></span>
<span class="line"></span></code></pre></div><p>Ah, essa foto pode explicar melhor:</p><p><img src="`+r+`" alt="projeto ssg 1"></p><p>E tamb\xE9m poder\xE1 ser importado em outro projeto python:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> projeto</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">name </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> modulo</span></span>
<span class="line"></span></code></pre></div><p>Para que tudo isso funcione, eu iniciei o projeto fazendo o setup do <code>poetry</code> com o <code>typer</code> dentro, e ficou muito maneiro.</p><p>Feito isso, eu pude come\xE7ar a desenvolver o primeiro m\xF3dulo que chamei de <code>ssg</code> com dois simples comandos <code>markdown-to-db</code> e <code>build</code>. Como os nomes j\xE1 explicam, o primeiro comando vai iterar em todos os posts que tenho no formato do <code>Zola</code> framework e colocar dentro do <code>sqlite</code> do projeto. E o segundo comando vai iterar sobre os artigos do <code>sqlite</code>, criando todas as publica\xE7\xF5es, pagina\xE7\xF5es e sitemaps. E tudo isso est\xE1 funcionando lindo!</p><p>Esse lance de modularizar via CLI \xE9 muito legal mesmo, eu j\xE1 tinha feito algo em <code>Node</code> no passado mas foi a primeira vez fazendo algo assim em <code>python</code> e gostei.</p><p>Al\xE9m disso, logo que terminei de organizar isso e iniciei o m\xF3dulo <code>ssg</code>, precisei estudar um pouco e conhecer as ferramentas de template engine para escolher alguma que fosse amig\xE1vel para meu projeto. Optei pelo <code>jinja2</code>, \xE9 bem poderoso e a documenta\xE7\xE3o \xE9 legal, baseado no que eu preciso ele est\xE1 atendendo muito bem e gostei da performance. Por hora ele est\xE1 legal.</p><p>Inclusive, falando de templates, consegui reaproveitar at\xE9 que bem meu template atual que foi feito para o <code>Zola</code>, claro que precisei fazer algumas adapta\xE7\xF5es, at\xE9 por que vou manter esse template como o template base da ferramenta, mas foi bem tranquilo fazer isso.</p><p>J\xE1 modelei o sistema para aceitar templates customizados, ent\xE3o se o blog n\xE3o tiver uma pasta <code>templates</code> dentro dele, o template padr\xE3o vai ser utilizado. Preciso fazer algumas melhorias em rela\xE7\xE3o a isso, at\xE9 para ficar mais f\xE1cil criar os pr\xF3ximos templates, mas por hora vou avan\xE7ar com o template base em mente.</p><p>Tenho uma s\xE9rie de melhorias para fazer e deixar tudo mais amig\xE1vel, mas estou focado em tentar ter um equilibrio nesse primeiro m\xF3dulo pois preciso virar a chave e come\xE7ar a migrar meus blogs para esse novo projeto, ent\xE3o estou equilibrando entre otimizar de mais e entregar os recursos.</p><p>Caramba, j\xE1 parou para pensar que expor suas ideias em tempo real de forma coesa \xE9 quase que uma arte? \xC9 relativamente complexo mas extremamente subestimado, tirar as ideias da cabe\xE7a e escreve-las de maneira que algu\xE9m possa compreender, \xE9 necess\xE1rio uma organiza\xE7\xE3o do fluxo mental para isso e tamb\xE9m um tanto de paci\xEAncia. Em outras palavras, preciso manter esse ritmo para aprimorar essa habilidade, isso me ajuda a organizar os pensamentos e expor minhas id\xE9ias.</p><p>Ent\xE3o finalizando, o meu framework/cli/toolkit/sei-la j\xE1 est\xE1 fazendo a build do meu site de forma aceit\xE1vel. Tenho alguns pequenas features planejadas para poder dizer que finalizei o m\xF3dulo de <code>ssg</code> e partir para o pr\xF3ximo. Alias, se voc\xEA ficou perdido, o m\xF3dulo <code>ssg</code> \xE9 o recurso respons\xE1vel por construir sites. <code>SSG</code> significa em portugu\xEAs &quot;Gerador de Sites Est\xE1ticos&quot; e eu digo que \xE9 um m\xF3dulo pois ter\xE3o outros m\xF3dulos respons\xE1veis por outras coisas que eu preciso para fazer a gest\xE3o dos meus projetos relacionados a isso.</p><p>Ent\xE3o, ainda faltam algumas coisas no <code>ssg</code> mas tamb\xE9m e principalmente muita analise no resultado gerado, pois h\xE1 todo um trabalho necess\xE1rio para que os projetos sejam indexados adequadamente e eu preciso analisar muito bem antes de virar a chave, para garantir que eu n\xE3o perca indexa\xE7\xF5es e acessos que eu j\xE1 tenho nos projetos.</p><p>E \xE9 isso isso por hora! Valeu \u{1F603}</p>`,32),m=[t];function n(d,p,u,c,l,g){return a(),o("div",null,m)}const v=e(i,[["render",n]]);export{q as __pageData,v as default};
